{{- $sslEnabled := include "kafka.ssl.enabled" (dict "global" $ "variation" "main") }}
{{- $password := .Values.kafka.main.password }}
{{- if or ($sslEnabled) (not (empty $password)) }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "keys.kafka-main.name" . | quote }}
  labels:
    {{- include "keys.labels" . | nindent 4 }}
type: Opaque
data:
  {{- if $sslEnabled }}
  client.crt: {{ required "A valid kafka.main.tls.cert entry required" .Values.kafka.main.tls.cert | b64enc | quote }}
  client.key: {{ required "A valid kafka.main.tls.key entry required" .Values.kafka.main.tls.key | b64enc | quote }}
  ca.crt: {{ required "A valid kafka.main.tls.rootCert entry required" .Values.kafka.main.tls.rootCert | b64enc | quote }}
  {{- end }}
  {{- with $password }}
  password: {{ $password | b64enc }}
  {{- end }}
{{- end }}
