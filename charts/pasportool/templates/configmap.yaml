{{- with .Values -}}

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "pasportool.name" $ }}
  labels:
    {{- include "pasportool.labels" $ | nindent 4 }}
data:
  config.yaml: |
    license:
      path: {{ required "A valid $.Values.licensePath entry is required" .licensePath }}
      update-period: {{ .updatePeriod }}
      retry-period: {{ .retryPeriod }}
      warning-period: {{ .softBlockPeriod }}
    server:
      host: 0.0.0.0
      port: 80
    {{- with .dgctlStorage }}
    storage:
      type: s3
      s3:
        host: {{ required "A valid $.Values.dgctlStorage.host entry is required" .host }}
        bucket: {{ required "A valid $.Values.dgctlStorage.bucket entry is required" .bucket }}
    {{- end }}

{{- end -}}
