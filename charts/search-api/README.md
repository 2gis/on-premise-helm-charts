# 2GIS Search API service

Use this Helm chart to deploy Search API service, which is a part of 2GIS's [On-Premise Search services](https://docs.2gis.com/en/on-premise/search).

Read more about the On-Premise solution [here](https://docs.2gis.com/en/on-premise/overview).

> **Note:**
>
> All On-Premise services are beta, and under development.

See the [documentation](https://docs.2gis.com/en/on-premise/search) to learn about:

- Architecture of the service.

- Installing the service.

    When filling in the keys for `values-search.yaml` configuration file, refer to the documentation and the list of keys below.

- Updating the service.

## Values

### Worker settings

| Name                                                       | Description                                                                                                                                                                                  | Value                           |
| ---------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------- |
| `worker.replicaCount`                                      | Number of worker replicas (used if HPA is disabled)                                                                                                                                          | `2`                             |
| `worker.matchLabels`                                       | Selector match labels                                                                                                                                                                        | `{}`                            |
| `worker.podLabels`                                         | Kubernetes [pod labels](https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/)                                                                                           | `{}`                            |
| `worker.podAnnotations`                                    | Kubernetes [pod annotations](https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/)                                                                                 | `{}`                            |
| `worker.podSecurityContext`                                | Kubernetes [podSecurityContext](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)                                                                                  | `{}`                            |
| `worker.imagePullSecrets`                                  | Kubernetes image pull secrets                                                                                                                                                                | `[]`                            |
| `worker.image.repository`                                  | Image Repository                                                                                                                                                                             | `2gis-on-premise/search-worker` |
| `worker.image.pullPolicy`                                  | Image [pull policy](https://kubernetes.io/docs/concepts/containers/images/#image-pull-policy)                                                                                                | `IfNotPresent`                  |
| `worker.image.tag`                                         | Image Tag                                                                                                                                                                                    | `8.16.1`                        |
| `worker.ports.http`                                        | HTTP port used by the worker                                                                                                                                                                 | `8092`                          |
| `worker.ports.grpc`                                        | gRPC port used by the worker                                                                                                                                                                 | `8091`                          |
| `worker.loggerLevel`                                       | Log level of the worker app; can be `trace`, `debug`, `info`, `warning`, `error`, or `critical`                                                                                              | `info`                          |
| `worker.loggerFormat`                                      | Log format used by the worker; Userver supports `tskv`, `ltsv`, `raw`, `json`, `json_yadeploy`. We recommend using `json`                                                                    | `json`                          |
| `worker.workerMainThreads`                                 | Number of main task processor threads                                                                                                                                                        | `4`                             |
| `worker.workerFbThreads`                                   | Number of fallback task processor threads                                                                                                                                                    | `4`                             |
| `worker.dataUpdateFrequencySec`                            | Frequency (in seconds) at which the worker updates data (indexes and RTW)                                                                                                                    | `60`                            |
| `worker.rtw.lifeTime`                                      | Lifetime of Real-Time Weights (in seconds)                                                                                                                                                   | `1800`                          |
| `worker.queueLimit`                                        | Maximum number of tasks in the main task processor queue. If exceeded, tasks are sent to the fallback processor                                                                              | `30`                            |
| `worker.executeDebugCommands`                              | Enables execution of debug commands (e.g., simulating head or worker crashes)                                                                                                                | `false`                         |
| `worker.securityContext`                                   | Kubernetes [SecurityContext](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)                                                                                     | `{}`                            |
| `worker.resources.requests.cpu`                            | A CPU request, recommended value `1400m`                                                                                                                                                     |                                 |
| `worker.resources.requests.memory`                         | A memory request, recommended value `3840Mi`                                                                                                                                                 |                                 |
| `worker.resources.limits.cpu`                              | A CPU limit, recommended value `6000m`                                                                                                                                                       |                                 |
| `worker.resources.limits.memory`                           | A memory limit, recommended value `6Gi`                                                                                                                                                      |                                 |
| `worker.livenessProbe.enabled`                             | Enable of livenessProbe                                                                                                                                                                      | `true`                          |
| `worker.livenessProbe.httpGet.path`                        | HTTP path for livenessProbe                                                                                                                                                                  | `/status`                       |
| `worker.livenessProbe.httpGet.port`                        | HTTP port for livenessProbe                                                                                                                                                                  | `http-port`                     |
| `worker.livenessProbe.httpGet.scheme`                      | Scheme for livenessProbe                                                                                                                                                                     | `HTTP`                          |
| `worker.livenessProbe.timeoutSeconds`                      | Timeout (in seconds) for the liveness probe                                                                                                                                                  | `1`                             |
| `worker.livenessProbe.periodSeconds`                       | Interval (in seconds) between liveness probe checks                                                                                                                                          | `5`                             |
| `worker.livenessProbe.successThreshold`                    | Minimum consecutive successes for the readiness probe to be considered successful                                                                                                            | `1`                             |
| `worker.livenessProbe.failureThreshold`                    | Number of failures before the readiness probe is considered failed                                                                                                                           | `36`                            |
| `worker.readinessProbe.enabled`                            | Enable readiness probe                                                                                                                                                                       | `true`                          |
| `worker.readinessProbe.httpGet.path`                       | HTTP path for the readiness probe                                                                                                                                                            | `/status`                       |
| `worker.readinessProbe.httpGet.port`                       | HTTP port for the readiness probe                                                                                                                                                            | `http-port`                     |
| `worker.readinessProbe.httpGet.scheme`                     | HTTP scheme for the readiness probe                                                                                                                                                          | `HTTP`                          |
| `worker.readinessProbe.timeoutSeconds`                     | Timeout (in seconds) for the readiness probe                                                                                                                                                 | `1`                             |
| `worker.readinessProbe.periodSeconds`                      | Interval (in seconds) between readiness probe checks                                                                                                                                         | `5`                             |
| `worker.readinessProbe.successThreshold`                   | Minimum consecutive successes for the readiness probe to be considered successful                                                                                                            | `1`                             |
| `worker.readinessProbe.failureThreshold`                   | Number of failures before the readiness probe is considered failed                                                                                                                           | `3`                             |
| `worker.startupProbe.enabled`                              | Enable startup probe                                                                                                                                                                         | `true`                          |
| `worker.startupProbe.httpGet.path`                         | HTTP path for the startup probe                                                                                                                                                              | `/ready`                        |
| `worker.startupProbe.httpGet.port`                         | HTTP port for the startup probe                                                                                                                                                              | `http-syncer`                   |
| `worker.startupProbe.httpGet.scheme`                       | HTTP scheme for the startup probe                                                                                                                                                            | `HTTP`                          |
| `worker.startupProbe.initialDelaySeconds`                  | Initial delay (in seconds) before starting the startup probe                                                                                                                                 | `30`                            |
| `worker.startupProbe.timeoutSeconds`                       | Timeout (in seconds) for the startup probe                                                                                                                                                   | `2`                             |
| `worker.startupProbe.periodSeconds`                        | Interval (in seconds) between startup probe checks                                                                                                                                           | `10`                            |
| `worker.startupProbe.successThreshold`                     | Minimum consecutive successes for the startup probe to be considered successful                                                                                                              | `1`                             |
| `worker.startupProbe.failureThreshold`                     | Number of failures before the startup probe is considered failed                                                                                                                             | `200`                           |
| `worker.prestopHook.enabled`                               | Enable or disable the container lifecycle preStop hook                                                                                                                                       | `true`                          |
| `worker.hpa.enabled`                                       | Enable or disable Horizontal Pod Autoscaler (HPA)                                                                                                                                            | `false`                         |
| `worker.hpa.minReplicas`                                   | Lower limit for the number of replicas to which the autoscaler can scale down                                                                                                                | `36`                            |
| `worker.hpa.maxReplicas`                                   | Upper limit for the number of replicas to which the autoscaler can scale up                                                                                                                  | `300`                           |
| `worker.hpa.averageCPUValue`                               | Target average CPU utilization (represented as a direct value of requested CPU); if not specified the default autoscaling policy will be used                                                | `1200m`                         |
| `worker.hpa.behavior.scaleDown.policies[0].periodSeconds`  | Indicates the length of time in the past for which the policy must hold true                                                                                                                 | `180`                           |
| `worker.hpa.behavior.scaleDown.policies[0].type`           | The type of amount by which the pod count should be reduced; This can be a percentage of the current pod count or a specific number of pods                                                  | `Percent`                       |
| `worker.hpa.behavior.scaleDown.policies[0].value`          | The amount by which the pod count should be increased                                                                                                                                        | `3`                             |
| `worker.hpa.behavior.scaleDown.stabilizationWindowSeconds` | The stabilization window is used to restrict the flapping of replica count when the metrics used for scaling keep fluctuating                                                                | `1200`                          |
| `worker.hpa.behavior.scaleUp.selectPolicy`                 | By setting the value to Min which would select the policy which allows the smallest change in the replica count; Setting the value to Disabled completely disables scaling in that direction | `Min`                           |
| `worker.hpa.behavior.scaleUp.policies[0].periodSeconds`    | Indicates the length of time in the past for which the policy must hold true                                                                                                                 | `15`                            |
| `worker.hpa.behavior.scaleUp.policies[0].type`             | The type of amount by which the pod count should be increased; This can be a percentage of the current pod count or a specific number of pods                                                | `Percent`                       |
| `worker.hpa.behavior.scaleUp.policies[0].value`            | The amount by which the pod count should be increased                                                                                                                                        | `10`                            |
| `worker.hpa.behavior.scaleUp.policies[1].type`             | The type of amount by which the pod count should be increased; This can be a percentage of the current pod count or a specific number of pods                                                | `Pods`                          |
| `worker.hpa.behavior.scaleUp.policies[1].value`            | The amount by which the pod count should be increased                                                                                                                                        | `5`                             |
| `worker.hpa.behavior.scaleUp.policies[1].periodSeconds`    | Indicates the length of time in the past for which the policy must hold true                                                                                                                 | `15`                            |
| `worker.hpa.behavior.scaleUp.stabilizationWindowSeconds`   | The stabilization window is used to restrict the flapping of replica count when the metrics used for scaling keep fluctuating                                                                | `30`                            |
| `worker.vpa.enabled`                                       | Enable or disable Vertical Pod Autoscaler (VPA)                                                                                                                                              | `false`                         |
| `worker.vpa.updateMode`                                    | VPA operating mode: `Off` means VPA will not automatically change resource requests                                                                                                          | `Off`                           |
| `worker.nodeSelector`                                      | Kubernetes [node selectors](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector)                                                                           | `{}`                            |
| `worker.tolerations`                                       | Kubernetes [tolerations](https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/) settings                                                                             | `[]`                            |
| `worker.affinity`                                          | Kubernetes pod [affinity settings](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#node-affinity)                                                                   | `{}`                            |
| `worker.data.persistent.enabled`                           | Enable persistent volume for the service                                                                                                                                                     | `false`                         |
| `worker.data.storageClassName`                             | Storage class to use. See Kubernetes [storageClassName](https://kubernetes.io/docs/concepts/storage/storage-classes/)                                                                        | `""`                            |
| `worker.data.resources.requests.storage`                   | Storage volume size                                                                                                                                                                          | `8Gi`                           |
| `worker.strategy.type`                                     | Kubernetes deployment strategy. Can be `Recreate` or `RollingUpdate`. See [Strategy](https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#strategy)                         | `RollingUpdate`                 |
| `worker.strategy.rollingUpdate.maxUnavailable`             | Maximum number of pods that can be unavailable during a [rolling update](https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#rolling-update-deployment)                    | `5%`                            |
| `worker.strategy.rollingUpdate.maxSurge`                   | Maximum number of extra pods that can be created during a [rolling update](https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#rolling-update-deployment)                  | `5%`                            |
| `worker.revisionHistoryLimit`                              | Number of old ReplicaSets to retain for [rollback](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/)                                                           | `10`                            |

### Head settings

| Name                                                     | Description                                                                                                                                                                                                                                       | Value                                                    |
| -------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------- |
| `head.replicaCount`                                      | Number of head replicas (used if HPA is disabled)                                                                                                                                                                                                 | `1`                                                      |
| `head.matchLabels`                                       | Selector match labels                                                                                                                                                                                                                             | `{}`                                                     |
| `head.podLabels`                                         | Kubernetes [pod labels](https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/)                                                                                                                                                | `{}`                                                     |
| `head.podAnnotations`                                    | Kubernetes [pod annotations](https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/)                                                                                                                                      | `{}`                                                     |
| `head.podSecurityContext`                                | Kubernetes [podSecurityContext](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)                                                                                                                                       | `{}`                                                     |
| `head.imagePullSecrets`                                  | Kubernetes image pull secrets                                                                                                                                                                                                                     | `[]`                                                     |
| `head.head.image.repository`                             | Docker image repository                                                                                                                                                                                                                           | `2gis-on-premise/search-head`                            |
| `head.head.image.pullPolicy`                             | Image [pull policy](https://kubernetes.io/docs/concepts/containers/images/#image-pull-policy)                                                                                                                                                     | `IfNotPresent`                                           |
| `head.head.image.tag`                                    | Docker image tag                                                                                                                                                                                                                                  | `8.16.1`                                                 |
| `head.head.ports.http`                                   | TCP port for requests to the Head service                                                                                                                                                                                                         | `9090`                                                   |
| `head.head.ports.monitor`                                | TCP port for service endpoints such as /metrics, etc.                                                                                                                                                                                             | `9091`                                                   |
| `head.head.securityContext`                              | Kubernetes [SecurityContext](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)                                                                                                                                          | `{}`                                                     |
| `head.head.resources.requests.cpu`                       | CPU request; recommended value: `900m`                                                                                                                                                                                                            |                                                          |
| `head.head.resources.requests.memory`                    | Memory request; recommended value: `4600Mi`                                                                                                                                                                                                       |                                                          |
| `head.head.resources.limits.cpu`                         | CPU limit; recommended value: `2000m`                                                                                                                                                                                                             |                                                          |
| `head.head.resources.limits.memory`                      | Memory limit; recommended value: `8Gi`                                                                                                                                                                                                            |                                                          |
| `head.head.loggerLevel`                                  | Log level of the Head app; can be `trace`, `debug`, `info`, `warning`, `error`, or `critical`                                                                                                                                                     | `info`                                                   |
| `head.head.loggerFormat`                                 | Log format used by the Head app; Userver supports `tskv`, `ltsv`, `raw`, `json`, `json_yadeploy`. We recommend using `json`                                                                                                                       | `json`                                                   |
| `head.head.livenessProbe.enabled`                        | Enable liveness probe                                                                                                                                                                                                                             | `true`                                                   |
| `head.head.livenessProbe.httpGet.path`                   | HTTP path for the liveness probe                                                                                                                                                                                                                  | `/v2/status`                                             |
| `head.head.livenessProbe.httpGet.port`                   | HTTP port for the liveness probe                                                                                                                                                                                                                  | `http-nginx`                                             |
| `head.head.livenessProbe.httpGet.scheme`                 | HTTP scheme for the liveness probe                                                                                                                                                                                                                | `HTTP`                                                   |
| `head.head.livenessProbe.timeoutSeconds`                 | Timeout (in seconds) for the liveness probe                                                                                                                                                                                                       | `1`                                                      |
| `head.head.livenessProbe.periodSeconds`                  | Interval (in seconds) between liveness probe checks                                                                                                                                                                                               | `5`                                                      |
| `head.head.livenessProbe.successThreshold`               | Minimum consecutive successes for the liveness probe to be considered successful                                                                                                                                                                  | `1`                                                      |
| `head.head.livenessProbe.failureThreshold`               | Number of failures before the liveness probe is considered failed                                                                                                                                                                                 | `36`                                                     |
| `head.head.readinessProbe.enabled`                       | Enable readiness probe                                                                                                                                                                                                                            | `true`                                                   |
| `head.head.readinessProbe.httpGet.path`                  | HTTP path for the readiness probe                                                                                                                                                                                                                 | `/v2/search?q=55899224549773365&seg=1&searcher=Searcher` |
| `head.head.readinessProbe.httpGet.port`                  | HTTP port for the readiness probe                                                                                                                                                                                                                 | `http-nginx`                                             |
| `head.head.readinessProbe.httpGet.scheme`                | HTTP scheme for the readiness probe                                                                                                                                                                                                               | `HTTP`                                                   |
| `head.head.readinessProbe.timeoutSeconds`                | Timeout (in seconds) for the readiness probe                                                                                                                                                                                                      | `1`                                                      |
| `head.head.readinessProbe.periodSeconds`                 | Interval (in seconds) between readiness probe checks                                                                                                                                                                                              | `5`                                                      |
| `head.head.readinessProbe.successThreshold`              | Minimum consecutive successes for the readiness probe to be considered successful                                                                                                                                                                 | `1`                                                      |
| `head.head.readinessProbe.failureThreshold`              | Number of failures before the readiness probe is considered failed                                                                                                                                                                                | `3`                                                      |
| `head.head.startupProbe.enabled`                         | Enable startup probe                                                                                                                                                                                                                              | `true`                                                   |
| `head.head.startupProbe.httpGet.path`                    | HTTP path for the startup probe                                                                                                                                                                                                                   | `/ready`                                                 |
| `head.head.startupProbe.httpGet.port`                    | HTTP port for the startup probe                                                                                                                                                                                                                   | `http-syncer`                                            |
| `head.head.startupProbe.httpGet.scheme`                  | HTTP scheme for the startup probe                                                                                                                                                                                                                 | `HTTP`                                                   |
| `head.head.startupProbe.initialDelaySeconds`             | Initial delay (in seconds) before starting the startup probe                                                                                                                                                                                      | `30`                                                     |
| `head.head.startupProbe.timeoutSeconds`                  | Timeout (in seconds) for the startup probe                                                                                                                                                                                                        | `2`                                                      |
| `head.head.startupProbe.periodSeconds`                   | Interval (in seconds) between startup probe checks                                                                                                                                                                                                | `10`                                                     |
| `head.head.startupProbe.successThreshold`                | Minimum consecutive successes for the startup probe to be considered successful                                                                                                                                                                   | `1`                                                      |
| `head.head.startupProbe.failureThreshold`                | Number of failures before the startup probe is considered failed                                                                                                                                                                                  | `200`                                                    |
| `head.head.allowSearchExtendedParams`                    | Allow passing debug parameters in the request                                                                                                                                                                                                     | `true`                                                   |
| `head.head.prestopHook.enabled`                          | Enable or disable the container lifecycle preStop hook                                                                                                                                                                                            | `true`                                                   |
| `head.head.workerQueriesCount`                           | Number of parts into which a request is split before being sent to workers (map operation in map-reduce)                                                                                                                                          | `32`                                                     |
| `head.head.workerRetryAttempts`                          | Number of retry attempts to contact a worker                                                                                                                                                                                                      | `1`                                                      |
| `head.head.workerTimeoutMs`                              | Timeout (in milliseconds) for waiting for a response from a worker                                                                                                                                                                                | `2000`                                                   |
| `head.head.adsEnable`                                    | Enable or disable advertising                                                                                                                                                                                                                     | `true`                                                   |
| `head.head.bigSearchMode`                                | Enable or disable big search (`on`, `off`)                                                                                                                                                                                                        | `on`                                                     |
| `head.head.bigSearchSearchers`                           | List of searchers for which big search is enabled                                                                                                                                                                                                 | `[]`                                                     |
| `head.head.aiSuggestedQueries.enabled`                   | Enable or disable AI Suggested Queries                                                                                                                                                                                                            | `true`                                                   |
| `head.head.executeDebugCommands`                         | Enable execution of debug commands (e.g., simulating head or worker crashes)                                                                                                                                                                      | `false`                                                  |
| `head.head.throttle.enabled`                             | Enable or disable big search throttling                                                                                                                                                                                                           | `true`                                                   |
| `head.head.throttle.threshold`                           | Threshold value beyond which throttling is activated                                                                                                                                                                                              | `250`                                                    |
| `head.head.throttle.engageFactor`                        | Throttling engage rate                                                                                                                                                                                                                            | `60`                                                     |
| `head.head.throttle.releaseFactor`                       | Throttling release rate                                                                                                                                                                                                                           | `20`                                                     |
| `head.head.throttle.updateIntervalSeconds`               | Interval (in seconds) for updating the throttling level                                                                                                                                                                                           | `1`                                                      |
| `head.head.throttle.inputMetric.updateIntervalSeconds`   | Interval (in seconds) for updating the input metric value                                                                                                                                                                                         | `5`                                                      |
| `head.head.throttle.inputMetric.calculateForPeriods`     | Number of update periods to use for input metric calculation                                                                                                                                                                                      | `12`                                                     |
| `head.nginx.image.repository`                            | Docker image repository                                                                                                                                                                                                                           | `2gis-on-premise/search-nginx`                           |
| `head.nginx.image.pullPolicy`                            | Image [pull policy](https://kubernetes.io/docs/concepts/containers/images/#image-pull-policy)                                                                                                                                                     | `IfNotPresent`                                           |
| `head.nginx.image.tag`                                   | Docker image tag                                                                                                                                                                                                                                  | `1.25.11`                                                |
| `head.nginx.ports.http`                                  | HTTP port used by Nginx                                                                                                                                                                                                                           | `8080`                                                   |
| `head.nginx.securityContext`                             | Kubernetes [SecurityContext](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)                                                                                                                                          | `{}`                                                     |
| `head.nginx.resources.requests.cpu`                      | CPU request; recommended value: `100m`                                                                                                                                                                                                            |                                                          |
| `head.nginx.resources.requests.memory`                   | Memory request; recommended value: `64Mi`                                                                                                                                                                                                         |                                                          |
| `head.nginx.resources.limits.cpu`                        | CPU limit; recommended value: `250m`                                                                                                                                                                                                              |                                                          |
| `head.nginx.resources.limits.memory`                     | Memory limit; recommended value: `256Mi`                                                                                                                                                                                                          |                                                          |
| `head.nginx.keepAliveCount`                              | Maximum number of idle keepalive connections to upstream servers                                                                                                                                                                                  | `100`                                                    |
| `head.nginx.enableAccessLog`                             | Enable or disable access logs for each request (disabled to reduce log volume)                                                                                                                                                                    | `false`                                                  |
| `head.nginx.logLevel`                                    | Log level for Nginx; can be `trace`, `debug`, `info`, `warning`, `error`, or `critical`                                                                                                                                                           | `warn`                                                   |
| `head.envoy.image.repository`                            | Docker image repository                                                                                                                                                                                                                           | `2gis-on-premise/navi-envoy`                             |
| `head.envoy.image.pullPolicy`                            | Image [pull policy](https://kubernetes.io/docs/concepts/containers/images/#image-pull-policy)                                                                                                                                                     | `IfNotPresent`                                           |
| `head.envoy.image.tag`                                   | Docker image tag                                                                                                                                                                                                                                  | `1.36.2-tools`                                           |
| `head.envoy.ports.admin`                                 | Web access port for the Envoy admin console                                                                                                                                                                                                       | `9901`                                                   |
| `head.envoy.ports.grpc`                                  | gRPC port used by Envoy                                                                                                                                                                                                                           | `8091`                                                   |
| `head.envoy.securityContext`                             | Kubernetes [SecurityContext](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)                                                                                                                                          | `{}`                                                     |
| `head.envoy.resources.requests.cpu`                      | CPU request; recommended value: `200m`                                                                                                                                                                                                            |                                                          |
| `head.envoy.resources.requests.memory`                   | Memory request; recommended value: `128Mi`                                                                                                                                                                                                        |                                                          |
| `head.envoy.resources.limits.cpu`                        | CPU limit; recommended value: `800m`                                                                                                                                                                                                              |                                                          |
| `head.envoy.resources.limits.memory`                     | Memory limit; recommended value: `512Mi`                                                                                                                                                                                                          |                                                          |
| `head.envoy.enableAccessLog`                             | Enable or disable logging of requests passing through Envoy                                                                                                                                                                                       | `false`                                                  |
| `head.envoy.policy`                                      | Load balancing policy; can be `ROUND_ROBIN`, `LEAST_REQUEST`, or `RANDOM`                                                                                                                                                                         | `ROUND_ROBIN`                                            |
| `head.envoy.faultInjection.enabled`                      | Enables or disables the fault injection feature in Envoy for testing service resilience.                                                                                                                                                          | `false`                                                  |
| `head.envoy.faultInjection.clients.worker`               | Specifies the fault injection settings for the worker client; see [Envoy Fault Injection](https://www.envoyproxy.io/docs/envoy/latest/api-v3/extensions/filters/http/fault/v3/fault.proto#extensions-filters-http-fault-v3-httpfault).            | `{}`                                                     |
| `head.envoy.faultInjection.clients.qt`                   | Specifies the fault injection settings for the query transformer client; see [Envoy Fault Injection](https://www.envoyproxy.io/docs/envoy/latest/api-v3/extensions/filters/http/fault/v3/fault.proto#extensions-filters-http-fault-v3-httpfault). | `{}`                                                     |
| `head.envoy.faultInjection.clients.ai`                   | Specifies the fault injection settings for the AI vector search client; see [Envoy Fault Injection](https://www.envoyproxy.io/docs/envoy/latest/api-v3/extensions/filters/http/fault/v3/fault.proto#extensions-filters-http-fault-v3-httpfault).  | `{}`                                                     |
| `head.initSapphireDocs.resources`                        | **Kubernetes [resource management settings](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/)**                                                                                                                     |                                                          |
| `head.initSapphireDocs.resources.requests.cpu`           | CPU request; recommended value: `5m`                                                                                                                                                                                                              |                                                          |
| `head.initSapphireDocs.resources.requests.memory`        | Memory request; recommended value: `128Mi`                                                                                                                                                                                                        |                                                          |
| `head.initSapphireDocs.resources.limits.cpu`             | CPU limit; recommended value: `50m`                                                                                                                                                                                                               |                                                          |
| `head.initSapphireDocs.resources.limits.memory`          | Memory limit; recommended value: `128Mi`                                                                                                                                                                                                          |                                                          |
| `head.nodeSelector`                                      | Kubernetes [node selectors](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector)                                                                                                                                | `{}`                                                     |
| `head.tolerations`                                       | Kubernetes [tolerations](https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/) settings                                                                                                                                  | `[]`                                                     |
| `head.affinity`                                          | Kubernetes pod [affinity settings](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#node-affinity)                                                                                                                        | `{}`                                                     |
| `head.hpa.enabled`                                       | Enable or disable Horizontal Pod Autoscaler (HPA) for the service                                                                                                                                                                                 | `false`                                                  |
| `head.hpa.minReplicas`                                   | Minimum number of replicas the autoscaler can scale down to                                                                                                                                                                                       | `2`                                                      |
| `head.hpa.maxReplicas`                                   | Maximum number of replicas the autoscaler can scale up to                                                                                                                                                                                         | `50`                                                     |
| `head.hpa.averageCPUValue`                               | Target average CPU utilization (as a direct value of requested CPU); if not specified, the default autoscaling policy is used                                                                                                                     | `700m`                                                   |
| `head.hpa.behavior.scaleDown.policies[0].periodSeconds`  | Duration (in seconds) the policy must be true to take effect                                                                                                                                                                                      | `180`                                                    |
| `head.hpa.behavior.scaleDown.policies[0].type`           | Type of scaling (percentage or absolute number of pods to reduce)                                                                                                                                                                                 | `Percent`                                                |
| `head.hpa.behavior.scaleDown.policies[0].value`          | Number or percentage of pods to reduce                                                                                                                                                                                                            | `3`                                                      |
| `head.hpa.behavior.scaleDown.stabilizationWindowSeconds` | Stabilization window to prevent frequent replica count changes due to metric fluctuations                                                                                                                                                         | `600`                                                    |
| `head.hpa.behavior.scaleUp.selectPolicy`                 | Policy selection strategy: `Min` selects the smallest change; `Disabled` disables scaling in this direction                                                                                                                                       | `Max`                                                    |
| `head.hpa.behavior.scaleUp.policies[0].periodSeconds`    | Duration (in seconds) the policy must be true to take effect                                                                                                                                                                                      | `15`                                                     |
| `head.hpa.behavior.scaleUp.policies[0].type`             | Type of scaling (percentage or absolute number of pods to increase)                                                                                                                                                                               | `Percent`                                                |
| `head.hpa.behavior.scaleUp.policies[0].value`            | Number or percentage of pods to increase                                                                                                                                                                                                          | `10`                                                     |
| `head.hpa.behavior.scaleUp.stabilizationWindowSeconds`   | Stabilization window to prevent frequent replica count changes due to metric fluctuations                                                                                                                                                         | `30`                                                     |
| `head.vpa.enabled`                                       | Enable or disable Vertical Pod Autoscaler (VPA)                                                                                                                                                                                                   | `false`                                                  |
| `head.vpa.updateMode`                                    | VPA operating mode: `Off` means VPA will not automatically change resource requests                                                                                                                                                               | `Off`                                                    |
| `head.queryTransformer.enabled`                          | Enable or disable the queryTransformer                                                                                                                                                                                                            | `false`                                                  |
| `head.queryTransformer.searchersList`                    | List of searchers for which the queryTransformer will be enabled                                                                                                                                                                                  | `[]`                                                     |
| `head.queryTransformer.endpoint.address`                 | Address of the queryTransformer service                                                                                                                                                                                                           | `""`                                                     |
| `head.queryTransformer.endpoint.port`                    | Port of the queryTransformer service                                                                                                                                                                                                              | `6767`                                                   |
| `head.queryTransformer.endpoint.ssl`                     | Enable or disable TLS encryption for the queryTransformer service                                                                                                                                                                                 | `false`                                                  |
| `head.queryTransformer.timeoutMs`                        | Connection timeout (in milliseconds) for the queryTransformer service                                                                                                                                                                             | `20`                                                     |
| `head.aiVectorSearch.enabled`                            | Enable or disable aiVectorSearch                                                                                                                                                                                                                  | `false`                                                  |
| `head.aiVectorSearch.endpoint.address`                   | Address of the aiVectorSearch service                                                                                                                                                                                                             | `""`                                                     |
| `head.aiVectorSearch.endpoint.port`                      | Port of the aiVectorSearch service                                                                                                                                                                                                                | `50051`                                                  |
| `head.aiVectorSearch.endpoint.ssl`                       | Enable or disable TLS encryption for the aiVectorSearch service                                                                                                                                                                                   | `false`                                                  |
| `head.aiVectorSearch.clientFactoryName`                  | Client factory name for the aiVectorSearch client (used to enable/disable SSL when debugging locally)                                                                                                                                             | `grpc-client-factory`                                    |
| `head.aiVectorSearch.timeoutMs`                          | Connection timeout (in milliseconds) for the aiVectorSearch service                                                                                                                                                                               | `500`                                                    |
| `head.aiVectorSearch.searchers`                          | List of searchers for which aiVectorSearch will be enabled                                                                                                                                                                                        | `["ExpandingSearcher"]`                                  |
| `head.grpcClientCircuitBreaker.clients`                  | List of gRPC client circuit breaker configurations, each defining thresholds and behavior per client.                                                                                                                                             | `[]`                                                     |
| `head.data.persistent.enabled`                           | Enable or disable a persistent volume for the service                                                                                                                                                                                             | `false`                                                  |
| `head.data.storageClassName`                             | Storage class to use; see Kubernetes [storageClassName](https://kubernetes.io/docs/concepts/storage/storage-classes/)                                                                                                                             | `""`                                                     |
| `head.data.resources.requests.storage`                   | Requested storage volume size                                                                                                                                                                                                                     | `8Gi`                                                    |
| `head.strategy.type`                                     | Type of Kubernetes deployment strategy; can be `Recreate` or `RollingUpdate`. See [Strategy](https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#strategy)                                                                      | `RollingUpdate`                                          |
| `head.strategy.rollingUpdate.maxUnavailable`             | Maximum number of pods that can be unavailable during a [rolling update](https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#rolling-update-deployment)                                                                         | `5%`                                                     |
| `head.strategy.rollingUpdate.maxSurge`                   | Maximum number of extra pods that can be created during a [rolling update](https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#rolling-update-deployment)                                                                       | `5%`                                                     |
| `head.revisionHistoryLimit`                              | Number of old ReplicaSets to retain for [rollback](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/) purposes                                                                                                       | `10`                                                     |
| `indexerServices.externalFilesStorageUrl`                | Enable and define the external index storage URL; if empty, a custom indexing and storage system will be deployed                                                                                                                                 | `""`                                                     |
| `indexerServices.externalControllerUrl`                  | Enable and define the external controller api URL                                                                                                                                                                                                 | `""`                                                     |

### FileStorage settings

| Name                                              | Description                                                                                                                | Value                                  |
| ------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------- | -------------------------------------- |
| `filesStorage.matchLabels`                        | Selector match labels                                                                                                      | `{}`                                   |
| `filesStorage.podLabels`                          | Kubernetes [pod labels](https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/)                         | `{}`                                   |
| `filesStorage.podAnnotations`                     | Kubernetes [pod annotations](https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/)               | `{}`                                   |
| `filesStorage.ports.http`                         | HTTP port for REST API requests of the indexing system                                                                     | `8080`                                 |
| `filesStorage.image.pullPolicy`                   | Image [pull policy](https://kubernetes.io/docs/concepts/containers/images/#image-pull-policy)                              | `IfNotPresent`                         |
| `filesStorage.image.repository`                   | Docker image repository                                                                                                    | `2gis-on-premise/search-files_storage` |
| `filesStorage.image.tag`                          | Docker image tag                                                                                                           | `8.16.1`                               |
| `filesStorage.podSecurityContext`                 | Kubernetes [podSecurityContext](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)                | `{}`                                   |
| `filesStorage.imagePullSecrets`                   | Kubernetes image pull secrets                                                                                              | `[]`                                   |
| `filesStorage.nodeSelector`                       | Kubernetes [node selectors](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector)         | `{}`                                   |
| `filesStorage.tolerations`                        | Kubernetes [tolerations](https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/) settings           | `[]`                                   |
| `filesStorage.affinity`                           | Kubernetes pod [affinity settings](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#node-affinity) | `{}`                                   |
| `filesStorage.resources.requests.cpu`             | CPU request; recommended value: `500m`                                                                                     |                                        |
| `filesStorage.resources.requests.memory`          | Memory request; recommended value: `2Gi`                                                                                   |                                        |
| `filesStorage.resources.limits.cpu`               | CPU limit; recommended value: `8000m`                                                                                      |                                        |
| `filesStorage.resources.limits.memory`            | Memory limit; recommended value: `4Gi`                                                                                     |                                        |
| `filesStorage.livenessProbe.enabled`              | Enable liveness probe                                                                                                      | `true`                                 |
| `filesStorage.livenessProbe.httpGet.path`         | HTTP path for the liveness probe                                                                                           | `/ping`                                |
| `filesStorage.livenessProbe.httpGet.port`         | HTTP port for the liveness probe                                                                                           | `http`                                 |
| `filesStorage.livenessProbe.periodSeconds`        | Interval (in seconds) between liveness probe checks                                                                        | `5`                                    |
| `filesStorage.livenessProbe.timeoutSeconds`       | Timeout (in seconds) for the liveness probe                                                                                | `1`                                    |
| `filesStorage.livenessProbe.failureThreshold`     | Number of failures before the liveness probe is considered failed                                                          | `3`                                    |
| `filesStorage.livenessProbe.initialDelaySeconds`  | Initial delay (in seconds) before starting the liveness probe                                                              | `10`                                   |
| `filesStorage.readinessProbe.enabled`             | Enable readiness probe                                                                                                     | `true`                                 |
| `filesStorage.readinessProbe.httpGet.path`        | HTTP path for the readiness probe                                                                                          | `/ping`                                |
| `filesStorage.readinessProbe.httpGet.port`        | HTTP port for the readiness probe                                                                                          | `http`                                 |
| `filesStorage.readinessProbe.periodSeconds`       | Interval (in seconds) between readiness probe checks                                                                       | `5`                                    |
| `filesStorage.readinessProbe.timeoutSeconds`      | Timeout (in seconds) for the readiness probe                                                                               | `1`                                    |
| `filesStorage.readinessProbe.failureThreshold`    | Number of failures before the readiness probe is considered failed                                                         | `3`                                    |
| `filesStorage.readinessProbe.initialDelaySeconds` | Initial delay (in seconds) before starting the readiness probe                                                             | `10`                                   |
| `filesStorage.versionTTL`                         | Time to live for old (unused) index versions                                                                               | `168h`                                 |
| `filesStorage.loglevel`                           | Log level; can be `trace`, `debug`, `info`, `warning`, `error`, or `critical`                                              | `info`                                 |
| `filesStorage.data.persistent.enabled`            | Enable or disable a persistent volume for the service                                                                      | `false`                                |
| `filesStorage.data.storageClassName`              | Storage class to use; see Kubernetes [storageClassName](https://kubernetes.io/docs/concepts/storage/storage-classes/)      | `""`                                   |
| `filesStorage.data.resources.requests.storage`    | Requested storage volume size                                                                                              | `30Gi`                                 |

### Data Adapter settings

| Name                                             | Description                                                                                                                | Value                                 |
| ------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------- | ------------------------------------- |
| `dataAdapter.matchLabels`                        | Selector match labels                                                                                                      | `{}`                                  |
| `dataAdapter.podLabels`                          | Kubernetes [pod labels](https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/)                         | `{}`                                  |
| `dataAdapter.podAnnotations`                     | Kubernetes [pod annotations](https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/)               | `{}`                                  |
| `dataAdapter.ports.http`                         | HTTP port for REST API requests of the indexing system                                                                     | `8080`                                |
| `dataAdapter.image.repository`                   | Docker image repository                                                                                                    | `2gis-on-premise/search-data_adapter` |
| `dataAdapter.image.pullPolicy`                   | Image [pull policy](https://kubernetes.io/docs/concepts/containers/images/#image-pull-policy)                              | `IfNotPresent`                        |
| `dataAdapter.image.tag`                          | Docker image tag                                                                                                           | `8.16.1`                              |
| `dataAdapter.podSecurityContext`                 | Kubernetes [podSecurityContext](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)                | `{}`                                  |
| `dataAdapter.imagePullSecrets`                   | Kubernetes image pull secrets                                                                                              | `[]`                                  |
| `dataAdapter.nodeSelector`                       | Kubernetes [node selectors](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector)         | `{}`                                  |
| `dataAdapter.tolerations`                        | Kubernetes [tolerations](https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/) settings           | `[]`                                  |
| `dataAdapter.affinity`                           | Kubernetes pod [affinity settings](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#node-affinity) | `{}`                                  |
| `dataAdapter.resources.requests.cpu`             | CPU request; recommended value: `100m`                                                                                     |                                       |
| `dataAdapter.resources.requests.memory`          | Memory request; recommended value: `50Mi`                                                                                  |                                       |
| `dataAdapter.resources.limits.cpu`               | CPU limit; recommended value: `200m`                                                                                       |                                       |
| `dataAdapter.resources.limits.memory`            | Memory limit; recommended value: `1Gi`                                                                                     |                                       |
| `dataAdapter.livenessProbe.enabled`              | Enable liveness probe                                                                                                      | `true`                                |
| `dataAdapter.livenessProbe.httpGet.path`         | HTTP path for the liveness probe                                                                                           | `/ping`                               |
| `dataAdapter.livenessProbe.httpGet.port`         | HTTP port for the liveness probe                                                                                           | `http`                                |
| `dataAdapter.livenessProbe.periodSeconds`        | Interval (in seconds) between liveness probe checks                                                                        | `5`                                   |
| `dataAdapter.livenessProbe.timeoutSeconds`       | Timeout (in seconds) for the liveness probe                                                                                | `1`                                   |
| `dataAdapter.livenessProbe.failureThreshold`     | Number of failures before the liveness probe is considered failed                                                          | `3`                                   |
| `dataAdapter.livenessProbe.initialDelaySeconds`  | Initial delay (in seconds) before starting the liveness probe                                                              | `10`                                  |
| `dataAdapter.readinessProbe.enabled`             | Enable readiness probe                                                                                                     | `true`                                |
| `dataAdapter.readinessProbe.httpGet.path`        | HTTP path for the readiness probe                                                                                          | `/ready`                              |
| `dataAdapter.readinessProbe.httpGet.port`        | HTTP port for the readiness probe                                                                                          | `http`                                |
| `dataAdapter.readinessProbe.periodSeconds`       | Interval (in seconds) between readiness probe checks                                                                       | `5`                                   |
| `dataAdapter.readinessProbe.timeoutSeconds`      | Timeout (in seconds) for the readiness probe                                                                               | `1`                                   |
| `dataAdapter.readinessProbe.failureThreshold`    | Number of failures before the readiness probe is considered failed                                                         | `3`                                   |
| `dataAdapter.readinessProbe.initialDelaySeconds` | Initial delay (in seconds) before starting the readiness probe                                                             | `10`                                  |
| `dataAdapter.loglevel`                           | Log level; can be `trace`, `debug`, `info`, `warning`, `error`, or `critical`                                              | `info`                                |
| `dataAdapter.interval`                           | Update data interval                                                                                                       | `15s`                                 |
| `dataAdapter.data.resources.requests.storage`    | Requested storage volume size                                                                                              | `10Gi`                                |

### Controller settings

| Name                                            | Description                                                                                                                | Value                               |
| ----------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------- | ----------------------------------- |
| `controller.matchLabels`                        | Selector match labels                                                                                                      | `{}`                                |
| `controller.podLabels`                          | Kubernetes [pod labels](https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/)                         | `{}`                                |
| `controller.podAnnotations`                     | Kubernetes [pod annotations](https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/)               | `{}`                                |
| `controller.ports.http`                         | HTTP port for REST API requests of the indexing system                                                                     | `8080`                              |
| `controller.image.repository`                   | Docker image repository                                                                                                    | `2gis-on-premise/search-controller` |
| `controller.image.pullPolicy`                   | Image [pull policy](https://kubernetes.io/docs/concepts/containers/images/#image-pull-policy)                              | `IfNotPresent`                      |
| `controller.image.tag`                          | Docker image tag                                                                                                           | `8.16.1`                            |
| `controller.podSecurityContext`                 | Kubernetes [podSecurityContext](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)                | `{}`                                |
| `controller.imagePullSecrets`                   | Kubernetes image pull secrets                                                                                              | `[]`                                |
| `controller.nodeSelector`                       | Kubernetes [node selectors](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector)         | `{}`                                |
| `controller.tolerations`                        | Kubernetes [tolerations](https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/) settings           | `[]`                                |
| `controller.affinity`                           | Kubernetes pod [affinity settings](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#node-affinity) | `{}`                                |
| `controller.resources.requests.cpu`             | CPU request; recommended value: `100m`                                                                                     |                                     |
| `controller.resources.requests.memory`          | Memory request; recommended value: `50Mi`                                                                                  |                                     |
| `controller.resources.limits.cpu`               | CPU limit; recommended value: `200m`                                                                                       |                                     |
| `controller.resources.limits.memory`            | Memory limit; recommended value: `1Gi`                                                                                     |                                     |
| `controller.livenessProbe.enabled`              | Enable liveness probe                                                                                                      | `true`                              |
| `controller.livenessProbe.httpGet.path`         | HTTP path for the liveness probe                                                                                           | `/ping`                             |
| `controller.livenessProbe.httpGet.port`         | HTTP port for the liveness probe                                                                                           | `http`                              |
| `controller.livenessProbe.periodSeconds`        | Interval (in seconds) between liveness probe checks                                                                        | `5`                                 |
| `controller.livenessProbe.timeoutSeconds`       | Timeout (in seconds) for the liveness probe                                                                                | `1`                                 |
| `controller.livenessProbe.failureThreshold`     | Number of failures before the liveness probe is considered failed                                                          | `3`                                 |
| `controller.livenessProbe.initialDelaySeconds`  | Initial delay (in seconds) before starting the liveness probe                                                              | `10`                                |
| `controller.readinessProbe.enabled`             | Enable readiness probe                                                                                                     | `true`                              |
| `controller.readinessProbe.httpGet.path`        | HTTP path for the readiness probe                                                                                          | `/ping`                             |
| `controller.readinessProbe.httpGet.port`        | HTTP port for the readiness probe                                                                                          | `http`                              |
| `controller.readinessProbe.periodSeconds`       | Interval (in seconds) between readiness probe checks                                                                       | `5`                                 |
| `controller.readinessProbe.timeoutSeconds`      | Timeout (in seconds) for the readiness probe                                                                               | `1`                                 |
| `controller.readinessProbe.failureThreshold`    | Number of failures before the readiness probe is considered failed                                                         | `3`                                 |
| `controller.readinessProbe.initialDelaySeconds` | Initial delay (in seconds) before starting the readiness probe                                                             | `10`                                |
| `controller.loglevel`                           | Log level; can be `trace`, `debug`, `info`, `warning`, `error`, or `critical`                                              | `info`                              |
| `controller.projectListUrl`                     | URL of the project list for indexing                                                                                       | `""`                                |
| `controller.user`                               | Username for accessing the indexing project list                                                                           | `""`                                |
| `controller.password`                           | Password for accessing the indexing project list                                                                           | `""`                                |
| `controller.model`                              | Part of the index name                                                                                                     | `gis`                               |
| `controller.domain`                             | Part of the index name                                                                                                     | `v4`                                |
| `controller.interval`                           | Indexing task synchronization interval                                                                                     | `15s`                               |
| `controller.taskTimeout`                        | Timeout for completing an indexing task; after this time, the task is returned to the queue if not completed successfully  | `20m`                               |
| `controller.extraProjects`                      | Additional list of projects with their URLs                                                                                | `[]`                                |
| `controller.adWeightsEnable`                    | Enable or disable updating of ad weights                                                                                   | `true`                              |
| `controller.data.persistent.enabled`            | Enable or disable a persistent volume for the service                                                                      | `false`                             |
| `controller.data.storageClassName`              | Storage class to use; see Kubernetes [storageClassName](https://kubernetes.io/docs/concepts/storage/storage-classes/)      | `""`                                |
| `controller.data.resources.requests.storage`    | Requested storage volume size                                                                                              | `10Gi`                              |
| `controller.notAllowedProjectKeys`              | List of projects from the general list that should not be indexed                                                          | `[]`                                |

### Indexer settings

| Name                                                        | Description                                                                                                                   | Value                            |
| ----------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------- | -------------------------------- |
| `indexer.matchLabels`                                       | Selector match labels                                                                                                         | `{}`                             |
| `indexer.podLabels`                                         | Kubernetes [pod labels](https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/)                            | `{}`                             |
| `indexer.podAnnotations`                                    | Kubernetes [pod annotations](https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/)                  | `{}`                             |
| `indexer.replicaCount`                                      | Number of indexer replicas (used if HPA is disabled)                                                                          | `3`                              |
| `indexer.ports.http`                                        | HTTP port for REST API requests of the indexing system                                                                        | `8080`                           |
| `indexer.loglevel`                                          | Log level; can be `trace`, `debug`, `info`, `warning`, `error`, or `critical`                                                 | `info`                           |
| `indexer.image.repository`                                  | Docker image repository                                                                                                       | `2gis-on-premise/search-indexer` |
| `indexer.image.pullPolicy`                                  | Image [pull policy](https://kubernetes.io/docs/concepts/containers/images/#image-pull-policy)                                 | `IfNotPresent`                   |
| `indexer.image.tag`                                         | Docker image tag                                                                                                              | `8.16.1`                         |
| `indexer.podSecurityContext`                                | Kubernetes [podSecurityContext](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)                   | `{}`                             |
| `indexer.imagePullSecrets`                                  | Kubernetes image pull secrets                                                                                                 | `[]`                             |
| `indexer.nodeSelector`                                      | Kubernetes [node selectors](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector)            | `{}`                             |
| `indexer.tolerations`                                       | Kubernetes [tolerations](https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/) settings              | `[]`                             |
| `indexer.affinity`                                          | Kubernetes pod [affinity settings](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#node-affinity)    | `{}`                             |
| `indexer.resources.requests.cpu`                            | CPU request; recommended value: `500m`                                                                                        |                                  |
| `indexer.resources.requests.memory`                         | Memory request; recommended value: `2Gi`                                                                                      |                                  |
| `indexer.resources.limits.cpu`                              | CPU limit; recommended value: `4000m`                                                                                         |                                  |
| `indexer.resources.limits.memory`                           | Memory limit; recommended value: `16Gi`                                                                                       |                                  |
| `indexer.livenessProbe.enabled`                             | Enable liveness probe                                                                                                         | `true`                           |
| `indexer.livenessProbe.httpGet.path`                        | HTTP path for the liveness probe                                                                                              | `/ping`                          |
| `indexer.livenessProbe.httpGet.port`                        | HTTP port for the liveness probe                                                                                              | `http`                           |
| `indexer.livenessProbe.periodSeconds`                       | Interval (in seconds) between liveness probe checks                                                                           | `5`                              |
| `indexer.livenessProbe.timeoutSeconds`                      | Timeout (in seconds) for the liveness probe                                                                                   | `1`                              |
| `indexer.livenessProbe.failureThreshold`                    | Number of failures before the liveness probe is considered failed                                                             | `3`                              |
| `indexer.livenessProbe.initialDelaySeconds`                 | Initial delay (in seconds) before starting the liveness probe                                                                 | `10`                             |
| `indexer.readinessProbe.enabled`                            | Enable readiness probe                                                                                                        | `true`                           |
| `indexer.readinessProbe.httpGet.path`                       | HTTP path for the readiness probe                                                                                             | `/ping`                          |
| `indexer.readinessProbe.httpGet.port`                       | HTTP port for the readiness probe                                                                                             | `http`                           |
| `indexer.readinessProbe.periodSeconds`                      | Interval (in seconds) between readiness probe checks                                                                          | `5`                              |
| `indexer.readinessProbe.timeoutSeconds`                     | Timeout (in seconds) for the readiness probe                                                                                  | `1`                              |
| `indexer.readinessProbe.failureThreshold`                   | Number of failures before the readiness probe is considered failed                                                            | `3`                              |
| `indexer.readinessProbe.initialDelaySeconds`                | Initial delay (in seconds) before starting the readiness probe                                                                | `10`                             |
| `indexer.hpa.enabled`                                       | Enable or disable Horizontal Pod Autoscaler (HPA)                                                                             | `false`                          |
| `indexer.hpa.minReplicas`                                   | Minimum number of replicas the autoscaler can scale down to                                                                   | `2`                              |
| `indexer.hpa.maxReplicas`                                   | Maximum number of replicas the autoscaler can scale up to                                                                     | `50`                             |
| `indexer.hpa.averageCPUValue`                               | Target average CPU utilization (as a direct value of requested CPU); if not specified, the default autoscaling policy is used | `600m`                           |
| `indexer.hpa.behavior.scaleDown.policies[0].periodSeconds`  | Duration (in seconds) the policy must be true to take effect                                                                  | `15`                             |
| `indexer.hpa.behavior.scaleDown.policies[0].type`           | Type of scaling (percentage or absolute number of pods to reduce)                                                             | `Percent`                        |
| `indexer.hpa.behavior.scaleDown.policies[0].value`          | Number or percentage of pods to reduce                                                                                        | `100`                            |
| `indexer.hpa.behavior.scaleDown.stabilizationWindowSeconds` | Stabilization window to prevent frequent replica count changes due to metric fluctuations                                     | `60`                             |
| `indexer.hpa.behavior.scaleUp.selectPolicy`                 | Policy selection strategy: `Min` selects the smallest change; `Disabled` disables scaling in this direction                   | `Max`                            |
| `indexer.hpa.behavior.scaleUp.policies[0].periodSeconds`    | Duration (in seconds) the policy must be true to take effect                                                                  | `15`                             |
| `indexer.hpa.behavior.scaleUp.policies[0].type`             | Type of scaling (percentage or absolute number of pods to increase)                                                           | `Percent`                        |
| `indexer.hpa.behavior.scaleUp.policies[0].value`            | Number or percentage of pods to increase                                                                                      | `100`                            |
| `indexer.hpa.behavior.scaleUp.stabilizationWindowSeconds`   | Stabilization window to prevent frequent replica count changes due to metric fluctuations                                     | `0`                              |
| `indexer.vpa.enabled`                                       | Enable or disable Vertical Pod Autoscaler (VPA)                                                                               | `false`                          |
| `indexer.vpa.updateMode`                                    | VPA operating mode: `Off` means VPA will not automatically change resource requests                                           | `Off`                            |

### s3Client settings

| Name                       | Description                                          | Value   |
| -------------------------- | ---------------------------------------------------- | ------- |
| `s3Client.enabled`         | Enable or disable S3 support for the indexing system | `true`  |
| `s3Client.endpoint`        | S3 endpoint address                                  | `""`    |
| `s3Client.accessKeyId`     | S3 access key ID                                     | `""`    |
| `s3Client.secretAccessKey` | S3 secret access key                                 | `""`    |
| `s3Client.bucket`          | S3 bucket name                                       | `""`    |
| `s3Client.useSsl`          | Enable or disable SSL                                | `false` |

### Syncer settings

| Name                                   | Description                                                                                              | Value                               |
| -------------------------------------- | -------------------------------------------------------------------------------------------------------- | ----------------------------------- |
| `syncer.ports.http`                    | HTTP port for REST API requests of the indexing system                                                   | `8088`                              |
| `syncer.loglevel`                      | Log level; can be `trace`, `debug`, `info`, `warning`, `error`, or `critical`                            | `info`                              |
| `syncer.image.repository`              | Docker image repository                                                                                  | `2gis-on-premise/search-syncer_new` |
| `syncer.image.pullPolicy`              | Image [pull policy](https://kubernetes.io/docs/concepts/containers/images/#image-pull-policy)            | `IfNotPresent`                      |
| `syncer.image.tag`                     | Docker image tag                                                                                         | `8.16.1`                            |
| `syncer.securityContext`               | Kubernetes [SecurityContext](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/) | `{}`                                |
| `syncer.resources.requests.cpu`        | CPU request; recommended value: `20m`                                                                    |                                     |
| `syncer.resources.requests.memory`     | Memory request; recommended value: `128Mi`                                                               |                                     |
| `syncer.resources.limits.cpu`          | CPU limit; recommended value: `100m`                                                                     |                                     |
| `syncer.resources.limits.memory`       | Memory limit; recommended value: `256Mi`                                                                 |                                     |
| `syncer.initResources.requests.cpu`    | CPU request for the syncer init container; recommended value: `500m`                                     |                                     |
| `syncer.initResources.requests.memory` | Memory request for the syncer init container; recommended value: `128Mi`                                 |                                     |
| `syncer.initResources.limits.cpu`      | CPU limit for the syncer init container; recommended value: `2000m`                                      |                                     |
| `syncer.initResources.limits.memory`   | Memory limit for the syncer init container; recommended value: `256Mi`                                   |                                     |
| `syncer.endpoints.rtw`                 | Endpoint for downloading real-time weights                                                               | `""`                                |
| `syncer.endpoints.aiSuggestedQueries`  | Endpoint for downloading AI Suggested Queries                                                            | `""`                                |
| `GINMODE`                              | Go application operating mode; default is `release`, `debug` mode is also supported                      | `release`                           |

### Magg settings

| Name                             | Description                                                                                                                                                                                                          | Value                                |
| -------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------ |
| `magg.enabled`                   | Enable or disable the metrics aggregator container                                                                                                                                                                   | `false`                              |
| `magg.image.repository`          | Docker image repository                                                                                                                                                                                              | `2gis-on-premise/metrics-aggregator` |
| `magg.image.pullPolicy`          | Image [pull policy](https://kubernetes.io/docs/concepts/containers/images/#image-pull-policy)                                                                                                                        | `IfNotPresent`                       |
| `magg.image.tag`                 | Docker image tag                                                                                                                                                                                                     | `0.1.0`                              |
| `magg.ports.metrics`             | HTTP port for Prometheus to scrape metrics                                                                                                                                                                           | `9999`                               |
| `magg.resources.requests.cpu`    | CPU request; recommended value: `10m`                                                                                                                                                                                |                                      |
| `magg.resources.requests.memory` | Memory request; recommended value: `32Mi`                                                                                                                                                                            |                                      |
| `magg.resources.limits.cpu`      | CPU limit; recommended value: `100m`                                                                                                                                                                                 |                                      |
| `magg.resources.limits.memory`   | Memory limit; recommended value: `128Mi`                                                                                                                                                                             |                                      |
| `serviceAccount.create`          | Specifies whether a ServiceAccount should be created                                                                                                                                                                 | `false`                              |
| `serviceAccount.automount`       | Set to `false` to opt out of automounting API credentials. See [credential automounting](https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#opt-out-of-api-credential-automounting) | `false`                              |
| `serviceAccount.annotations`     | Annotations to add to the ServiceAccount                                                                                                                                                                             | `{}`                                 |
| `serviceAccount.name`            | Name of the ServiceAccount to use                                                                                                                                                                                    | `""`                                 |
| `service.worker.port`            | Service (svc) port for the worker                                                                                                                                                                                    | `8091`                               |
| `service.head.type`              | Service (svc) type for the head component                                                                                                                                                                            | `ClusterIP`                          |
| `service.head.port`              | Service (svc) port for the head component                                                                                                                                                                            | `8080`                               |
| `service.head.external.enable`   | Temporary internal 2GIS parameter for On-Prem; should be disabled                                                                                                                                                    | `false`                              |
| `service.filesStorage.port`      | Service (svc) port for the filesStorage component                                                                                                                                                                    | `80`                                 |
| `service.dataAdapter.port`       | Service (svc) port for the dataAdapter component                                                                                                                                                                     | `80`                                 |
| `service.controller.port`        | Service (svc) port for the controller component                                                                                                                                                                      | `80`                                 |
| `service.indexer.port`           | Service (svc) port for the indexer component                                                                                                                                                                         | `80`                                 |
| `service.ingressRouter.port`     | Service (svc) port for the ingress-router                                                                                                                                                                            | `9092`                               |
| `service.geodetector.port`       | Service (svc) port for the geodetector component                                                                                                                                                                     | `10091`                              |

### ingressRouter

| Name                                                              | Description                                                                                                                                                   | Value                                   |
| ----------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------- |
| `ingressRouter.enabled`                                           | Enable or disable ingressRouter                                                                                                                               | `true`                                  |
| `ingressRouter.replicaCount`                                      | Number of replicas for ingressRouter (used if HPA is disabled)                                                                                                | `1`                                     |
| `ingressRouter.livenessProbe.enabled`                             | Enable liveness probe                                                                                                                                         | `true`                                  |
| `ingressRouter.livenessProbe.httpGet.path`                        | HTTP path for the liveness probe                                                                                                                              | `/status`                               |
| `ingressRouter.livenessProbe.httpGet.port`                        | HTTP port for the liveness probe                                                                                                                              | `ingress-router`                        |
| `ingressRouter.livenessProbe.httpGet.scheme`                      | HTTP scheme for the liveness probe                                                                                                                            | `HTTP`                                  |
| `ingressRouter.livenessProbe.timeoutSeconds`                      | Timeout (in seconds) for the liveness probe                                                                                                                   | `1`                                     |
| `ingressRouter.livenessProbe.periodSeconds`                       | Interval (in seconds) between liveness probe checks                                                                                                           | `5`                                     |
| `ingressRouter.livenessProbe.successThreshold`                    | Minimum consecutive successes for the liveness probe                                                                                                          | `1`                                     |
| `ingressRouter.livenessProbe.failureThreshold`                    | Number of failures before the liveness probe is considered failed                                                                                             | `4`                                     |
| `ingressRouter.readinessProbe.enabled`                            | Enable readiness probe                                                                                                                                        | `true`                                  |
| `ingressRouter.readinessProbe.httpGet.path`                       | HTTP path for the readiness probe                                                                                                                             | `/status`                               |
| `ingressRouter.readinessProbe.httpGet.port`                       | HTTP port for the readiness probe                                                                                                                             | `ingress-router`                        |
| `ingressRouter.readinessProbe.httpGet.scheme`                     | HTTP scheme for the readiness probe                                                                                                                           | `HTTP`                                  |
| `ingressRouter.readinessProbe.timeoutSeconds`                     | Timeout (in seconds) for the readiness probe                                                                                                                  | `1`                                     |
| `ingressRouter.readinessProbe.periodSeconds`                      | Interval (in seconds) between readiness probe checks                                                                                                          | `5`                                     |
| `ingressRouter.readinessProbe.successThreshold`                   | Minimum consecutive successes for the readiness probe                                                                                                         | `1`                                     |
| `ingressRouter.readinessProbe.failureThreshold`                   | Number of failures before the readiness probe is considered failed                                                                                            | `2`                                     |
| `ingressRouter.startupProbe.enabled`                              | Enable startup probe                                                                                                                                          | `true`                                  |
| `ingressRouter.startupProbe.httpGet.path`                         | HTTP path for the startup probe                                                                                                                               | `/status`                               |
| `ingressRouter.startupProbe.httpGet.port`                         | HTTP port for the startup probe                                                                                                                               | `ingress-router`                        |
| `ingressRouter.startupProbe.httpGet.scheme`                       | HTTP scheme for the startup probe                                                                                                                             | `HTTP`                                  |
| `ingressRouter.startupProbe.initialDelaySeconds`                  | Initial delay (in seconds) before starting the startup probe                                                                                                  | `5`                                     |
| `ingressRouter.startupProbe.timeoutSeconds`                       | Timeout (in seconds) for the startup probe                                                                                                                    | `1`                                     |
| `ingressRouter.startupProbe.periodSeconds`                        | Interval (in seconds) between startup probe checks                                                                                                            | `5`                                     |
| `ingressRouter.startupProbe.successThreshold`                     | Minimum consecutive successes for the startup probe                                                                                                           | `1`                                     |
| `ingressRouter.startupProbe.failureThreshold`                     | Number of failures before the startup probe is considered failed                                                                                              | `5`                                     |
| `ingressRouter.loggerLevel`                                       | Log level; can be `trace`, `debug`, `info`, `warning`, `error`, or `critical`                                                                                 | `info`                                  |
| `ingressRouter.loggerFormat`                                      | Log format; Userver supports `tskv`, `ltsv`, `raw`, `json`, `json_yadeploy`. Recommended: `json`                                                              | `json`                                  |
| `ingressRouter.resources.requests.cpu`                            | CPU request; recommended value: `1`                                                                                                                           |                                         |
| `ingressRouter.resources.requests.memory`                         | Memory request; recommended value: `400Mi`                                                                                                                    |                                         |
| `ingressRouter.resources.limits.cpu`                              | CPU limit; recommended value: `2`                                                                                                                             |                                         |
| `ingressRouter.resources.limits.memory`                           | Memory limit; recommended value: `2Gi`                                                                                                                        |                                         |
| `ingressRouter.hpa.enabled`                                       | Enable or disable Horizontal Pod Autoscaler (HPA)                                                                                                             | `false`                                 |
| `ingressRouter.hpa.minReplicas`                                   | Minimum number of replicas                                                                                                                                    | `2`                                     |
| `ingressRouter.hpa.maxReplicas`                                   | Maximum number of replicas                                                                                                                                    | `5`                                     |
| `ingressRouter.hpa.averageCPUValue`                               | Target average CPU utilization (as a direct value of requested CPU)                                                                                           | `700m`                                  |
| `ingressRouter.hpa.behavior.scaleDown.policies[0].periodSeconds`  | Duration (in seconds) the policy must be true                                                                                                                 | `180`                                   |
| `ingressRouter.hpa.behavior.scaleDown.policies[0].type`           | Type of scaling (percentage or absolute number of pods to reduce)                                                                                             | `Percent`                               |
| `ingressRouter.hpa.behavior.scaleDown.policies[0].value`          | Number or percentage of pods to reduce                                                                                                                        | `3`                                     |
| `ingressRouter.hpa.behavior.scaleDown.stabilizationWindowSeconds` | Stabilization window to prevent flapping                                                                                                                      | `1200`                                  |
| `ingressRouter.hpa.behavior.scaleUp.selectPolicy`                 | Policy selection strategy: `Min` or `Disabled`                                                                                                                | `Min`                                   |
| `ingressRouter.hpa.behavior.scaleUp.policies[0].periodSeconds`    | Duration (in seconds) the policy must be true                                                                                                                 | `15`                                    |
| `ingressRouter.hpa.behavior.scaleUp.policies[0].type`             | Type of scaling (percentage or absolute number of pods to increase)                                                                                           | `Percent`                               |
| `ingressRouter.hpa.behavior.scaleUp.policies[0].value`            | Number or percentage of pods to increase                                                                                                                      | `10`                                    |
| `ingressRouter.hpa.behavior.scaleUp.policies[1].periodSeconds`    | Duration (in seconds) the policy must be true                                                                                                                 | `15`                                    |
| `ingressRouter.hpa.behavior.scaleUp.policies[1].type`             | Type of scaling (percentage or absolute number of pods to increase)                                                                                           | `Pods`                                  |
| `ingressRouter.hpa.behavior.scaleUp.policies[1].value`            | Number or percentage of pods to increase                                                                                                                      | `5`                                     |
| `ingressRouter.hpa.behavior.scaleUp.stabilizationWindowSeconds`   | Stabilization window to prevent flapping                                                                                                                      | `30`                                    |
| `ingressRouter.vpa.enabled`                                       | Enable or disable Vertical Pod Autoscaler (VPA)                                                                                                               | `false`                                 |
| `ingressRouter.vpa.updateMode`                                    | VPA operating mode; `Off` means no automatic resource changes                                                                                                 | `Off`                                   |
| `ingressRouter.imagePullSecrets`                                  | Kubernetes image pull secrets                                                                                                                                 | `[]`                                    |
| `ingressRouter.dispatcherComponent.enabled`                       | Enable or disable request dispatching                                                                                                                         | `false`                                 |
| `ingressRouter.rateLimitComponent.enabled`                        | Enable or disable rate limiting                                                                                                                               | `false`                                 |
| `ingressRouter.prestopHook.enabled`                               | Enable or disable container lifecycle [preStop hook](https://kubernetes.io/docs/concepts/containers/container-lifecycle-hooks/)                               | `true`                                  |
| `ingressRouter.podSecurityContext`                                | Kubernetes [podSecurityContext](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)                                                   | `{}`                                    |
| `ingressRouter.envoy.securityContext`                             | Kubernetes [SecurityContext](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)                                                      | `{}`                                    |
| `ingressRouter.envoy.image.repository`                            | Docker image repository                                                                                                                                       | `envoyproxy/envoy`                      |
| `ingressRouter.envoy.image.pullPolicy`                            | Image [pull policy](https://kubernetes.io/docs/concepts/containers/images/#image-pull-policy)                                                                 | `IfNotPresent`                          |
| `ingressRouter.envoy.image.tag`                                   | Docker image tag                                                                                                                                              | `v1.28.0`                               |
| `ingressRouter.envoy.resources.requests.cpu`                      | CPU request; recommended value: `200m`                                                                                                                        |                                         |
| `ingressRouter.envoy.resources.requests.memory`                   | Memory request; recommended value: `128Mi`                                                                                                                    |                                         |
| `ingressRouter.envoy.resources.limits.cpu`                        | CPU limit; recommended value: `800m`                                                                                                                          |                                         |
| `ingressRouter.envoy.resources.limits.memory`                     | Memory limit; recommended value: `512Mi`                                                                                                                      |                                         |
| `ingressRouter.envoy.ports.admin`                                 | HTTP port for Envoy admin console                                                                                                                             | `9901`                                  |
| `ingressRouter.envoy.ports.grpc`                                  | gRPC port used by Envoy                                                                                                                                       | `8091`                                  |
| `ingressRouter.tolerations`                                       | Kubernetes [tolerations](https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/) settings                                              | `[]`                                    |
| `ingressRouter.nodeSelector`                                      | Kubernetes [node selectors](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector)                                            | `{}`                                    |
| `ingressRouter.affinity`                                          | Kubernetes pod [affinity settings](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#node-affinity)                                    | `{}`                                    |
| `ingressRouter.strategy.type`                                     | Deployment strategy; can be `Recreate` or `RollingUpdate`. See [Strategy](https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#strategy)     | `RollingUpdate`                         |
| `ingressRouter.strategy.rollingUpdate.maxUnavailable`             | Maximum number of unavailable pods during a [rolling update](https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#rolling-update-deployment) | `25%`                                   |
| `ingressRouter.strategy.rollingUpdate.maxSurge`                   | Maximum number of extra pods during a [rolling update](https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#rolling-update-deployment)       | `25%`                                   |
| `ingressRouter.image.repository`                                  | Docker image repository                                                                                                                                       | `2gis-on-premise/search-ingress-router` |
| `ingressRouter.image.pullPolicy`                                  | Image [pull policy](https://kubernetes.io/docs/concepts/containers/images/#image-pull-policy)                                                                 | `IfNotPresent`                          |
| `ingressRouter.image.tag`                                         | Docker image tag                                                                                                                                              | `8.16.1`                                |
| `ingressRouter.matchLabels`                                       | Selector match labels                                                                                                                                         | `{}`                                    |
| `ingressRouter.podLabels`                                         | Kubernetes [pod labels](https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/)                                                            | `{}`                                    |
| `ingressRouter.sapphireUrl`                                       | Custom URL for the `head` service                                                                                                                             | `""`                                    |
| `ingressRouter.sapphireRequestTimeoutMs`                          | Timeout (in ms) for requests to the `head` service                                                                                                            | `5000`                                  |
| `ingressRouter.prometheusUrl`                                     | Prometheus URL for rate limiting                                                                                                                              | `""`                                    |
| `ingressRouter.rateLimitRules`                                    | Big Search usage quotas                                                                                                                                       | `[]`                                    |
| `ingressRouter.ports.monitor`                                     | TCP port for service endpoints such as `/metrics`                                                                                                             | `9093`                                  |
| `ingressRouter.ports.http`                                        | TCP port for API requests                                                                                                                                     | `9092`                                  |
| `ingressRouter.headers`                                           | Header used for request dispatching                                                                                                                           | `X-Cluster-Index`                       |
| `ingressRouter.routing.sapphireBase.port`                         | Port of the AB Sapphire base service                                                                                                                          | `8080`                                  |
| `ingressRouter.routing.sapphireBase.exactMatch`                   | Header value for AB Sapphire base                                                                                                                             | `0`                                     |
| `ingressRouter.routing.cluster1.port`                             | Port of cluster 1 head service                                                                                                                                | `9092`                                  |
| `ingressRouter.routing.cluster1.address`                          | Address of cluster 1 head service                                                                                                                             | `big-search-ab-cluster1-ingress-router` |
| `ingressRouter.routing.cluster1.exactMatch`                       | Header value for cluster 1                                                                                                                                    | `1`                                     |
| `ingressRouter.routing.cluster2.port`                             | Port of cluster 2 head service                                                                                                                                | `9092`                                  |
| `ingressRouter.routing.cluster2.address`                          | Address of cluster 2 head service                                                                                                                             | `big-search-ab-cluster2-ingress-router` |
| `ingressRouter.routing.cluster2.exactMatch`                       | Header value for cluster 2                                                                                                                                    | `2`                                     |
| `ingressRouter.routing.cluster3.port`                             | Port of cluster 3 head service                                                                                                                                | `9092`                                  |
| `ingressRouter.routing.cluster3.address`                          | Address of cluster 3 head service                                                                                                                             | `big-search-ab-cluster3-ingress-router` |
| `ingressRouter.routing.cluster3.exactMatch`                       | Header value for cluster 3                                                                                                                                    | `3`                                     |

### geodetector

| Name                                                            | Description                                                                                                                                                   | Value                                |
| --------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------ |
| `geodetector.enabled`                                           | Enable or disable the geodetector service                                                                                                                     | `true`                               |
| `geodetector.replicaCount`                                      | Number of replicas for geodetector (used if HPA is disabled)                                                                                                  | `1`                                  |
| `geodetector.image.repository`                                  | Docker image repository                                                                                                                                       | `2gis-on-premise/search-geodetector` |
| `geodetector.image.pullPolicy`                                  | Image [pull policy](https://kubernetes.io/docs/concepts/containers/images/#image-pull-policy)                                                                 | `IfNotPresent`                       |
| `geodetector.image.tag`                                         | Docker image tag                                                                                                                                              | `8.16.1`                             |
| `geodetector.imagePullSecrets`                                  | Kubernetes image pull secrets                                                                                                                                 | `[]`                                 |
| `geodetector.geodetectorGrpcThreads`                            | Number of threads for gRPC execution                                                                                                                          | `2`                                  |
| `geodetector.dataUpdateFrequencySec`                            | Frequency (in seconds) of index information updates                                                                                                           | `60`                                 |
| `geodetector.geodetectorMainThreads`                            | Number of threads per main handler                                                                                                                            | `4`                                  |
| `geodetector.geodetectorFsThreads`                              | Number of threads for FS task processor                                                                                                                       | `2`                                  |
| `geodetector.geodetectorMonThreads`                             | Number of threads allocated for collecting metrics                                                                                                            | `2`                                  |
| `geodetector.loggerLevel`                                       | Log level; can be `trace`, `debug`, `info`, `warning`, `error`, or `critical`                                                                                 | `info`                               |
| `geodetector.loggerFormat`                                      | Log format; Userver supports `tskv`, `ltsv`, `raw`, `json`, `json_yadeploy`. Recommended: `json`                                                              | `json`                               |
| `geodetector.executeDebugCommands`                              | Enable execution of debug commands (e.g., simulate crash)                                                                                                     | `true`                               |
| `geodetector.matchLabels`                                       | Selector match labels                                                                                                                                         | `{}`                                 |
| `geodetector.podLabels`                                         | Kubernetes [pod labels](https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/)                                                            | `{}`                                 |
| `geodetector.podAnnotations`                                    | Kubernetes [pod annotations](https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/)                                                  | `{}`                                 |
| `geodetector.podSecurityContext`                                | Kubernetes [podSecurityContext](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)                                                   | `{}`                                 |
| `geodetector.securityContext`                                   | Kubernetes [SecurityContext](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)                                                      | `{}`                                 |
| `geodetector.hpa.enabled`                                       | Enable or disable Horizontal Pod Autoscaler (HPA)                                                                                                             | `false`                              |
| `geodetector.hpa.minReplicas`                                   | Minimum number of replicas                                                                                                                                    | `2`                                  |
| `geodetector.hpa.maxReplicas`                                   | Maximum number of replicas                                                                                                                                    | `3`                                  |
| `geodetector.hpa.averageCPUValue`                               | Target average CPU utilization (as a direct value of requested CPU)                                                                                           | `700m`                               |
| `geodetector.hpa.behavior.scaleDown.policies[0].periodSeconds`  | Duration (in seconds) the policy must be true                                                                                                                 | `180`                                |
| `geodetector.hpa.behavior.scaleDown.policies[0].type`           | Type of scaling (percentage or absolute number of pods to reduce)                                                                                             | `Percent`                            |
| `geodetector.hpa.behavior.scaleDown.policies[0].value`          | Number or percentage of pods to reduce                                                                                                                        | `3`                                  |
| `geodetector.hpa.behavior.scaleDown.stabilizationWindowSeconds` | Stabilization window to prevent flapping                                                                                                                      | `1200`                               |
| `geodetector.hpa.behavior.scaleUp.selectPolicy`                 | Policy selection strategy: `Min` or `Disabled`                                                                                                                | `Min`                                |
| `geodetector.hpa.behavior.scaleUp.policies[0].periodSeconds`    | Duration (in seconds) the policy must be true                                                                                                                 | `15`                                 |
| `geodetector.hpa.behavior.scaleUp.policies[0].type`             | Type of scaling (percentage or absolute number of pods to increase)                                                                                           | `Percent`                            |
| `geodetector.hpa.behavior.scaleUp.policies[0].value`            | Number or percentage of pods to increase                                                                                                                      | `10`                                 |
| `geodetector.hpa.behavior.scaleUp.policies[1].periodSeconds`    | Duration (in seconds) the policy must be true                                                                                                                 | `15`                                 |
| `geodetector.hpa.behavior.scaleUp.policies[1].type`             | Type of scaling (percentage or absolute number of pods to increase)                                                                                           | `Pods`                               |
| `geodetector.hpa.behavior.scaleUp.policies[1].value`            | Number or percentage of pods to increase                                                                                                                      | `5`                                  |
| `geodetector.hpa.behavior.scaleUp.stabilizationWindowSeconds`   | Stabilization window to prevent flapping                                                                                                                      | `30`                                 |
| `geodetector.vpa.enabled`                                       | Enable or disable Vertical Pod Autoscaler (VPA)                                                                                                               | `false`                              |
| `geodetector.vpa.updateMode`                                    | VPA operating mode; `Off` means no automatic resource changes                                                                                                 | `Off`                                |
| `geodetector.ports.grpc`                                        | gRPC port for API requests                                                                                                                                    | `10091`                              |
| `geodetector.ports.server`                                      | gRPC server port                                                                                                                                              | `10092`                              |
| `geodetector.ports.monitor`                                     | Port for Prometheus metrics                                                                                                                                   | `10093`                              |
| `geodetector.resources.requests.cpu`                            | CPU request; recommended value: `1`                                                                                                                           |                                      |
| `geodetector.resources.requests.memory`                         | Memory request; recommended value: `4000Mi`                                                                                                                   |                                      |
| `geodetector.resources.limits.cpu`                              | CPU limit; recommended value: `2`                                                                                                                             |                                      |
| `geodetector.resources.limits.memory`                           | Memory limit; recommended value: `6Gi`                                                                                                                        |                                      |
| `geodetector.data.resources.requests.storage`                   | Requested storage volume size                                                                                                                                 | `8Gi`                                |
| `geodetector.data.storageClassName`                             | Storage class to use; see Kubernetes [storageClassName](https://kubernetes.io/docs/concepts/storage/storage-classes/)                                         | `""`                                 |
| `geodetector.data.persistent.enabled`                           | Enable or disable persistent volume for the service                                                                                                           | `true`                               |
| `geodetector.livenessProbe.enabled`                             | Enable liveness probe                                                                                                                                         | `true`                               |
| `geodetector.livenessProbe.httpGet.path`                        | HTTP path for the liveness probe                                                                                                                              | `/status`                            |
| `geodetector.livenessProbe.httpGet.port`                        | HTTP port for the liveness probe                                                                                                                              | `geodetector-srv`                    |
| `geodetector.livenessProbe.httpGet.scheme`                      | HTTP scheme for the liveness probe                                                                                                                            | `HTTP`                               |
| `geodetector.livenessProbe.timeoutSeconds`                      | Timeout (in seconds) for the liveness probe                                                                                                                   | `1`                                  |
| `geodetector.livenessProbe.periodSeconds`                       | Interval (in seconds) between liveness probe checks                                                                                                           | `5`                                  |
| `geodetector.livenessProbe.successThreshold`                    | Minimum consecutive successes for the liveness probe                                                                                                          | `1`                                  |
| `geodetector.livenessProbe.failureThreshold`                    | Number of failures before the liveness probe is considered failed                                                                                             | `36`                                 |
| `geodetector.readinessProbe.enabled`                            | Enable readiness probe                                                                                                                                        | `true`                               |
| `geodetector.readinessProbe.httpGet.path`                       | HTTP path for the readiness probe                                                                                                                             | `/status`                            |
| `geodetector.readinessProbe.httpGet.port`                       | HTTP port for the readiness probe                                                                                                                             | `geodetector-srv`                    |
| `geodetector.readinessProbe.httpGet.scheme`                     | HTTP scheme for the readiness probe                                                                                                                           | `HTTP`                               |
| `geodetector.readinessProbe.timeoutSeconds`                     | Timeout (in seconds) for the readiness probe                                                                                                                  | `1`                                  |
| `geodetector.readinessProbe.periodSeconds`                      | Interval (in seconds) between readiness probe checks                                                                                                          | `5`                                  |
| `geodetector.readinessProbe.successThreshold`                   | Minimum consecutive successes for the readiness probe                                                                                                         | `1`                                  |
| `geodetector.readinessProbe.failureThreshold`                   | Number of failures before the readiness probe is considered failed                                                                                            | `3`                                  |
| `geodetector.startupProbe.enabled`                              | Enable startup probe                                                                                                                                          | `true`                               |
| `geodetector.startupProbe.httpGet.path`                         | HTTP path for the startup probe                                                                                                                               | `/ready`                             |
| `geodetector.startupProbe.httpGet.port`                         | HTTP port for the startup probe                                                                                                                               | `http-syncer`                        |
| `geodetector.startupProbe.httpGet.scheme`                       | HTTP scheme for the startup probe                                                                                                                             | `HTTP`                               |
| `geodetector.startupProbe.initialDelaySeconds`                  | Initial delay (in seconds) before starting the startup probe                                                                                                  | `30`                                 |
| `geodetector.startupProbe.timeoutSeconds`                       | Timeout (in seconds) for the startup probe                                                                                                                    | `2`                                  |
| `geodetector.startupProbe.periodSeconds`                        | Interval (in seconds) between startup probe checks                                                                                                            | `10`                                 |
| `geodetector.startupProbe.successThreshold`                     | Minimum consecutive successes for the startup probe                                                                                                           | `1`                                  |
| `geodetector.startupProbe.failureThreshold`                     | Number of failures before the startup probe is considered failed                                                                                              | `200`                                |
| `geodetector.prestopHook.enabled`                               | Enable or disable container lifecycle [preStop hook](https://kubernetes.io/docs/concepts/containers/container-lifecycle-hooks/)                               | `true`                               |
| `geodetector.strategy.type`                                     | Deployment strategy; can be `Recreate` or `RollingUpdate`. See [Strategy](https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#strategy)     | `RollingUpdate`                      |
| `geodetector.strategy.rollingUpdate.maxUnavailable`             | Maximum number of unavailable pods during a [rolling update](https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#rolling-update-deployment) | `25%`                                |
| `geodetector.strategy.rollingUpdate.maxSurge`                   | Maximum number of extra pods during a [rolling update](https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#rolling-update-deployment)       | `25%`                                |
| `geodetector.nodeSelector`                                      | Kubernetes [node selectors](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector)                                            | `{}`                                 |
| `geodetector.tolerations`                                       | Kubernetes [tolerations](https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/) settings                                              | `[]`                                 |
| `geodetector.affinity`                                          | Kubernetes pod [affinity settings](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#node-affinity)                                    | `{}`                                 |

### Ingress settings

| Name                                 | Description                                        | Value                    |
| ------------------------------------ | -------------------------------------------------- | ------------------------ |
| `ingress.enabled`                    | Enable or disable Ingress for the service          | `false`                  |
| `ingress.className`                  | Name of the Ingress controller class               | `nginx`                  |
| `ingress.annotations`                | Annotations to apply to the Ingress resource       | `{}`                     |
| `ingress.hosts[0].host`              | Hostname for the Ingress service                   | `search-api.example.com` |
| `ingress.hosts[0].paths[0].path`     | Path for the specified host in the Ingress service | `/`                      |
| `ingress.hosts[0].paths[0].pathType` | Type of path matching (e.g., `Prefix`, `Exact`)    | `ImplementationSpecific` |
| `ingress.tls`                        | TLS configuration for the Ingress resource         | `[]`                     |

### customCAs **Custom Certificate Authority**

| Name                  | Description                                                                                                                | Value  |
| --------------------- | -------------------------------------------------------------------------------------------------------------------------- | ------ |
| `customCAs.bundle`    | Custom CA [text representation of an X.509 PEM public-key certificate](https://www.rfc-editor.org/rfc/rfc7468#section-5.1) | `""`   |
| `customCAs.certsPath` | Mount path for the custom CA bundle inside the container. If empty, the default is: "/usr/local/share/ca-certificates"     | `""`   |
| `onpremise`           | Enable specific parameters for on-premise deployment                                                                       | `true` |

### Deployment Artifacts Storage settings

| Name                     | Description                                                                                                                                                                                                                                             | Value   |
| ------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------- |
| `dgctlStorage.host`      | S3 endpoint. Format: `host:port`                                                                                                                                                                                                                        | `""`    |
| `dgctlStorage.bucket`    | S3 bucket name                                                                                                                                                                                                                                          | `""`    |
| `dgctlStorage.accessKey` | S3 access key for accessing the bucket                                                                                                                                                                                                                  | `""`    |
| `dgctlStorage.secretKey` | S3 secret key for accessing the bucket                                                                                                                                                                                                                  | `""`    |
| `dgctlStorage.manifest`  | The path to the [manifest file](https://docs.2gis.com/en/on-premise/overview#nav-lvl2@paramCommon_deployment_steps). Format: `manifests/0000000000.json` <br> This file contains the description of pieces of data that the service requires to operate | `""`    |
| `dgctlStorage.secure`    | If S3 uses https.                                                                                                                                                                                                                                       | `false` |
| `dgctlStorage.region`    | S3 region                                                                                                                                                                                                                                               | `""`    |
